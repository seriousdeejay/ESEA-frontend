{"version":3,"sources":["webpack:///./src/views/organisation/OrganisationStakeholders.vue","webpack:///./src/components/MyUsers.vue","webpack:///./src/components/MyUsers.vue?6878","webpack:///./src/views/organisation/OrganisationStakeholders.vue?0ce9"],"names":["query","$route","params","OrganisationId","selection-enabled","class","style","left","selectionEnabled","selectionToggle","onLabel","offLabel","onIcon","offIcon","addingProcess","label","initialize","icon","Dialog","disabled","selectedRows","length","importDialog","addableUsers","right","filters","placeholder","users","ref","value","selection","selectionMode","dataKey","metaKeySelection","goToSelectedUser","paginator","rows","paginatorTemplate","rowsPerPageOptions","currentPageReportTemplate","columns","col","field","header","key","visible","modal","footer","addOrRemoveUsers","user","id","username","name","customUpload","onUpload","fileLimit","accept","maxFileSize","empty","props","type","Array","default","String","Boolean","data","computed","created","this","methods","fetchUsers","console","log","patchOrganisation","organisation","event","formData","FormData","append","files","Promise","resolve","reject","post","then","response","$toast","add","severity","summary","detail","catch","err","setUser","$router","push","render","components","MyUsers"],"mappings":"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","file":"js/chunk-2d0e493a.9990b98b.js","sourcesContent":["<template>\r\n    <my-users :query=\"`?organisation=${this.$route.params.OrganisationId}`\" selection-enabled></my-users>\r\n</template>\r\n\r\n<script>\r\nimport MyUsers from '../../components/MyUsers'\r\n\r\nexport default {\r\n    components: {\r\n        MyUsers\r\n    }\r\n}\r\n</script>\r\n","<template>\r\n    <Toolbar>\r\n        <template #left>\r\n        <ToggleButton v-if=\"selectionEnabled\" v-model=\"selectionToggle\" onLabel=\"Selecting: Enabled\" offLabel=\"Selecting: Disabled\" onIcon=\"pi pi-check\" offIcon=\"pi pi-times\" class=\"p-mr-2\" />\r\n            <div v-if=\"!addingProcess\">\r\n            <Button label=\"Import stakeholders\" icon=\"pi pi-upload\" class=\"p-button success p-mr-2\" @click=\"importDialog = true\" />\r\n            <Button label=\"Invite users\" icon=\"pi pi-plus\" class=\"p-button-success p-mr-2\" @click=\"addableUsers()\" />\r\n            <Button label=\"Remove members\" icon=\"pi pi-trash\" class=\"p-button-danger\" @click=\"Dialog = true\" :disabled=\"!selectedRows.length\" />\r\n            </div>\r\n            <div v-else>\r\n                <Button label=\"Show members\" class=\"p-button-secondary p-mr-2\" @click=\"initialize()\" />\r\n                <Button label=\"Invite selected Users\" icon=\"pi pi-plus\" class=\"p-button-success p-mr-2\" @click=\"Dialog=true\" :disabled=\"!selectedRows.length\"/>\r\n            </div>\r\n        </template>\r\n\r\n        <template #right>\r\n            <span class=\"p-input-icon-left\">\r\n                <i class=\"pi pi-search\" />\r\n                <InputText v-model=\"filters['global']\" placeholder=\"Search...\" />\r\n            </span>\r\n        </template>\r\n    </Toolbar>\r\n    <div v-if=\"users.length\">\r\n         <DataTable ref=\"dt\" :value=\"users\" v-model:selection=\"selectedRows\" :selectionMode=\"selectionToggle? 'multiple' : 'single'\" dataKey=\"id\" :metaKeySelection=\"false\" @row-select=\"goToSelectedUser\"\r\n        :paginator=\"true\" :rows=\"10\" :filters=\"filters\" paginatorTemplate=\"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown\"\r\n        :rowsPerPageOptions=\"[5,10,25]\" currentPageReportTemplate=\"Showing {first} to {last} of {totalRecords} products\" class=\"p-datatable-striped\">\r\n\r\n        <Column v-for=\"col of columns\" :field=\"col.field\" :header=\"col.header\" :key=\"col.field\" />\r\n        </Datatable>\r\n    </div>\r\n    <div v-else class=\"p-p-3\"><h3 class=\"p-text-light p-text-italic\">There are no users to display</h3></div>\r\n\r\n    <Dialog v-model:visible=\"Dialog\" :style=\"{width: '450px'}\" header=\"Confirm\" :modal=\"true\">\r\n        <div class=\"confirmation-content\">\r\n            <i class=\"pi pi-exclamation-triangle p-mr-3\" style=\"font-size: 2rem\" />\r\n            <span>Are you sure you want to {{addingProcess? 'join': 'delete'}}: </span>\r\n                <div v-for=\"user in selectedRows\" :key=\"user.id\">\r\n                    <b>{{user.username}} </b>\r\n                    </div>\r\n        </div>?\r\n        <template #footer>\r\n            <Button label=\"No\" icon=\"pi pi-times\" class=\"p-button-text\" @click=\"Dialog = false\"/>\r\n            <Button label=\"Yes\" icon=\"pi pi-check\" class=\"p-button-text\" @click=\"addOrRemoveUsers()\" />\r\n      </template>\r\n    </Dialog>\r\n\r\n    <Dialog v-model:visible=\"importDialog\" :style=\"{width: '450px'}\" header=\"Import your stakeholders\" :modal=\"true\" class=\"p-fluid\">\r\n        <FileUpload name=\"myfile\" :customUpload=\"true\" @uploader=\"onUpload\" :fileLimit=\"1\" accept=\".csv\" :maxFileSize=\"1000000\">\r\n            <template #empty>\r\n                <p>Drag and drop your csv file here to upload.</p>\r\n            </template>\r\n        </FileUpload>\r\n        <template #footer>\r\n            <Button label=\"Remove window\" icon=\"pi pi-times\" class=\"p-button-text\" @click=\"importDialog = false\"/>\r\n        </template>\r\n    </Dialog>\r\n</template>\r\n\r\n<script>\r\nimport { mapActions, mapState } from 'vuex'\r\nimport { AxiosInstance } from '../plugins/axios'\r\nexport default {\r\n    props: {\r\n        columns: {\r\n            type: Array,\r\n            default: function () {\r\n                return [\r\n                   { field: 'username', header: 'Username' },\r\n                   { field: 'first_name', header: 'First Name' },\r\n                    { field: 'last_name_prefix', header: 'Prefix' },\r\n                    { field: 'last_name', header: 'Last Name' }\r\n                    // { field: `${that.users.user_organisations[0].user}`, header: 'Stakeholder Group' }\r\n                    // stakeholder group\r\n                ]\r\n            }\r\n        },\r\n        query: {\r\n            type: String,\r\n            default: ''\r\n        },\r\n        selectionEnabled: {\r\n            type: Boolean,\r\n            default: false\r\n        }\r\n    },\r\n    data () {\r\n        return {\r\n            // columns: [\r\n            //         { field: 'username', header: 'Username' },\r\n            //         { field: 'first_name', header: 'First Name' },\r\n            //         { field: 'last_name_prefix', header: 'Prefix' },\r\n            //         { field: 'last_name', header: 'Last Name' },\r\n            //         { field: 'user_organisations[0]', header: 'Stakeholder Group' }\r\n            //         // stakeholder group\r\n            //     ],\r\n            filters: {},\r\n            selectedRows: [],\r\n            selectionToggle: false,\r\n            addingProcess: false,\r\n            Dialog: false,\r\n            importDialog: false\r\n        }\r\n    },\r\n    computed: {\r\n        ...mapState('user', ['users', 'user']),\r\n        ...mapState('organisation', ['organisation'])\r\n    },\r\n    created () {\r\n        this.initialize()\r\n    },\r\n    methods: {\r\n        ...mapActions('user', ['fetchUsers', 'setUser']),\r\n        ...mapActions('organisation', ['patchOrganisation']),\r\n        async initialize () {\r\n            await this.fetchUsers({ query: this.query })\r\n            this.selectedRows = []\r\n            this.addingProcess = false\r\n            // query: `excludeorganisation=${this.$route.params.id || 0}`\r\n        },\r\n        async addableUsers () {\r\n            console.log('>>', this.$route.params.OrganisationId)\r\n            await this.fetchUsers({ query: `?excludeorganisation=${this.$route.params.OrganisationId}` })\r\n            this.addingProcess = true\r\n            this.selectionToggle = true\r\n            this.selectedRows = []\r\n        },\r\n        async addOrRemoveUsers () {\r\n            await this.patchOrganisation({ id: this.organisation.id, data: this.selectedRows })\r\n            this.Dialog = false\r\n            this.initialize()\r\n        },\r\n        async onUpload (event) {\r\n            var formData = new FormData()\r\n            formData.append('file', event.files[0])\r\n            return new Promise((resolve, reject) => {\r\n                AxiosInstance.post(`/import-employees/${this.organisation?.id || 0}/`, formData)\r\n                .then(response => {\r\n                    console.log(response)\r\n                    this.importDialog = false\r\n                    this.$toast.add({ severity: 'success', summary: 'CSV uploaded', detail: 'Your csv was correctly uploaded.' })\r\n                    this.initialize()\r\n                resolve()\r\n                })\r\n                .catch(err => { reject(err) })\r\n            })\r\n        },\r\n        async goToSelectedUser (event) {\r\n            if (!this.selectionToggle) {\r\n                await this.setUser(event.data)\r\n                console.log(event.data)\r\n                this.$router.push({ name: 'userdetails', params: { id: this.user?.id || 0 } })\r\n            }\r\n        }\r\n    }\r\n}\r\n</script>\r\n","import { render } from \"./MyUsers.vue?vue&type=template&id=41647157\"\nimport script from \"./MyUsers.vue?vue&type=script&lang=js\"\nexport * from \"./MyUsers.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","import { render } from \"./OrganisationStakeholders.vue?vue&type=template&id=1802f4b9\"\nimport script from \"./OrganisationStakeholders.vue?vue&type=script&lang=js\"\nexport * from \"./OrganisationStakeholders.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script"],"sourceRoot":""}